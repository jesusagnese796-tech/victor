<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥ç§˜å¯»å®æ¸¸æˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: #fff;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        /* å…¨æ™¯åœ°å›¾æ ·å¼ */
        .panorama-map {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .location {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .location:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .location-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }
        
        .location h3 {
            margin-bottom: 10px;
            font-size: 1.5rem;
        }
        
        .location p {
            opacity: 0.8;
            margin-bottom: 15px;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* åœ°ç‚¹é¡µé¢æ ·å¼ */
        .location-page {
            display: none;
            padding: 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            margin-top: 20px;
            backdrop-filter: blur(10px);
        }
        
        .location-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .location-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .location-image {
            width: 100%;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        .location-description {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        
        .location-description h3 {
            margin-bottom: 15px;
            font-size: 1.5rem;
        }
        
        /* éŸ³ä¹æ§åˆ¶ */
        .music-controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 100;
        }
        
        .music-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            padding: 5px;
        }
        
        .volume-slider {
            width: 100px;
        }
        
        /* è¿›åº¦ä¿å­˜æç¤º */
        .save-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 5px;
            display: none;
            z-index: 100;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .location-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .panorama-map {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ç¥ç§˜å¯»å®æ¸¸æˆ</h1>
            <p class="subtitle">æ¢ç´¢ç¥ç§˜åœ°ç‚¹ï¼Œå¯»æ‰¾éšè—çš„å®è—ï¼</p>
        </header>
        
        <!-- å…¨æ™¯åœ°å›¾ -->
        <div class="panorama-map" id="panoramaMap">
            <!-- åœ°ç‚¹å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        
        <!-- åœ°ç‚¹é¡µé¢å®¹å™¨ -->
        <div id="locationPages">
            <!-- åœ°ç‚¹é¡µé¢å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
    </div>
    
    <!-- éŸ³ä¹æ§åˆ¶ -->
    <div class="music-controls">
        <button class="music-btn" id="prevMusic">â®</button>
        <button class="music-btn" id="playPause">â¯</button>
        <button class="music-btn" id="nextMusic">â­</button>
        <input type="range" min="0" max="1" step="0.01" value="0.5" class="volume-slider" id="volumeSlider">
    </div>
    
    <!-- ä¿å­˜æç¤º -->
    <div class="save-indicator" id="saveIndicator">
        æ¸¸æˆè¿›åº¦å·²ä¿å­˜ï¼
    </div>
    
    <!-- éŸ³é¢‘å…ƒç´  -->
    <audio id="backgroundMusic" loop>
        <!-- éŸ³ä¹å°†é€šè¿‡JavaScriptåŠ¨æ€è®¾ç½® -->
    </audio>
    
    <script>
        // æ¸¸æˆæ•°æ®
        const gameData = {
            // ä»localStorageåŠ è½½ä¿å­˜çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤å€¼
            currentLocation: localStorage.getItem('currentLocation') || 'panorama',
            visitedLocations: JSON.parse(localStorage.getItem('visitedLocations')) || [],
            musicVolume: localStorage.getItem('musicVolume') || 0.5,
            musicPlaying: localStorage.getItem('musicPlaying') === 'true' || false
        };
        
        // åœ°ç‚¹æ•°æ®
        const locations = [
            {
                id: 'ancientTemple',
                name: 'å¤è€ç¥åº™',
                icon: 'ğŸ›ï¸',
                description: 'ä¸€åº§è¢«é—å¿˜çš„å¤è€ç¥åº™ï¼Œéšè—ç€ç¥ç§˜çš„å®è—ã€‚',
                image: 'https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3',
                content: 'è¿™åº§ç¥åº™å·²ç»å­˜åœ¨äº†æ•°åƒå¹´ï¼Œå¢™å£ä¸Šåˆ»æ»¡äº†ç¥ç§˜çš„ç¬¦å·ã€‚æ®è¯´åœ¨æœˆåœ†ä¹‹å¤œï¼Œç¥åº™ä¼šæ˜¾ç°å‡ºéšè—çš„é€šé“ã€‚'
            },
            {
                id: 'enchantedForest',
                name: 'é­”æ³•æ£®æ—',
                icon: 'ğŸŒ²',
                description: 'å……æ»¡ç¥ç§˜ç”Ÿç‰©çš„é­”æ³•æ£®æ—ï¼Œæ¯ä¸€æ­¥éƒ½å¯èƒ½æœ‰æ„å¤–çš„å‘ç°ã€‚',
                image: 'https://images.unsplash.com/photo-1448375240586-882707db888b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3',
                content: 'é­”æ³•æ£®æ—ä¸­çš„æ ‘æœ¨ä¼šè¯´è¯ï¼Œå°åŠ¨ç‰©ä»¬ä¼šæŒ‡å¼•ä½ æ‰¾åˆ°éšè—çš„å®è—ã€‚ä½†è¦å°å¿ƒï¼Œæ£®æ—æ·±å¤„ä½ç€ä¸€ä½å¼ºå¤§çš„å·«å¸ˆã€‚'
            },
            {
                id: 'crystalCave',
                name: 'æ°´æ™¶æ´ç©´',
                icon: 'ğŸ’',
                description: 'é—ªè€€ç€ä¸ƒå½©å…‰èŠ’çš„æ°´æ™¶æ´ç©´ï¼Œæ¯ä¸€å—æ°´æ™¶éƒ½è•´å«ç€ç¥ç§˜çš„åŠ›é‡ã€‚',
                image: 'https://images.unsplash.com/photo-1534438327276-14e5300c3a48?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3',
                content: 'æ´ç©´æ·±å¤„çš„æ°´æ™¶æ•£å‘ç€å¥‡å¼‚çš„å…‰èŠ’ï¼Œæ®è¯´è¿™äº›æ°´æ™¶èƒ½å¤Ÿé¢„çŸ¥æœªæ¥ã€‚ä½†åªæœ‰çº¯æ´çš„å¿ƒçµæ‰èƒ½å®‰å…¨é€šè¿‡æ´ç©´ã€‚'
            },
            {
                id: 'pirateBay',
                name: 'æµ·ç›—æ¸¯æ¹¾',
                icon: 'âš“',
                description: 'æ›¾ç»æ˜¯æµ·ç›—ä»¬è—å®çš„åœ°æ–¹ï¼Œç°åœ¨åªå‰©ä¸‹ä¼ è¯´å’Œæœªå‘ç°çš„å®è—ã€‚',
                image: 'https://images.unsplash.com/photo-1506929562872-bb421503ef21?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-4.mp3',
                content: 'æ¸¯æ¹¾ä¸­åœæ³Šç€å¤è€çš„æ²‰èˆ¹ï¼Œæ¯ä¸€è‰˜èˆ¹éƒ½å¯èƒ½è—æœ‰æµ·ç›—çš„å®è—ã€‚ä½†è¦å°å¿ƒï¼Œæ®è¯´æœ‰äº›æµ·ç›—çš„å¹½çµä»ç„¶å®ˆæŠ¤ç€ä»–ä»¬çš„è´¢å®ã€‚'
            },
            {
                id: 'dragonPeak',
                name: 'é¾™ä¹‹å³°',
                icon: 'ğŸ‰',
                description: 'é«˜è€¸å…¥äº‘çš„å±±å³°ï¼Œä¼ è¯´ä¸­é¾™çš„å·¢ç©´ï¼Œéšè—ç€æœ€çè´µçš„å®è—ã€‚',
                image: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3',
                content: 'å±±å³°ä¹‹å·…æ˜¯ä¼ è¯´ä¸­çš„é¾™å·¢ï¼Œåªæœ‰æœ€å‹‡æ•¢çš„æ¢é™©å®¶æ‰èƒ½åˆ°è¾¾ã€‚æ®è¯´é¾™çš„å®è—ä¸­æœ‰ä¸€ä»¶èƒ½å¤Ÿå®ç°æ„¿æœ›çš„ç¥å™¨ã€‚'
            },
            {
                id: 'lostCity',
                name: 'å¤±è½ä¹‹åŸ',
                icon: 'ğŸ™ï¸',
                description: 'è¢«æ—¶é—´é—å¿˜çš„å¤è€åŸå¸‚ï¼Œæ¯ä¸€å—çŸ³å¤´éƒ½è¯‰è¯´ç€è¿‡å»çš„æ•…äº‹ã€‚',
                image: 'https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                music: 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-6.mp3',
                content: 'è¿™åº§åŸå¸‚çš„å±…æ°‘åœ¨ä¸€å¤œä¹‹é—´ç¥ç§˜æ¶ˆå¤±ï¼Œç•™ä¸‹äº†å®Œæ•´çš„å»ºç­‘å’Œæœªè§£ä¹‹è°œã€‚åŸå¸‚ä¸­å¿ƒçš„é‡‘å­—å¡”æ®è¯´éšè—ç€é€šå¾€å¦ä¸€ä¸ªä¸–ç•Œçš„é—¨æˆ·ã€‚'
            }
        ];
        
        // å…¨æ™¯åœ°å›¾éŸ³ä¹
        const panoramaMusic = 'https://www.soundhelix.com/examples/mp3/SoundHelix-Song-7.mp3';
        
        // DOMå…ƒç´ 
        const panoramaMap = document.getElementById('panoramaMap');
        const locationPages = document.getElementById('locationPages');
        const backgroundMusic = document.getElementById('backgroundMusic');
        const playPauseBtn = document.getElementById('playPause');
        const prevMusicBtn = document.getElementById('prevMusic');
        const nextMusicBtn = document.getElementById('nextMusic');
        const volumeSlider = document.getElementById('volumeSlider');
        const saveIndicator = document.getElementById('saveIndicator');
        
        // å½“å‰éŸ³ä¹ç´¢å¼•
        let currentMusicIndex = 0;
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            // ç”Ÿæˆå…¨æ™¯åœ°å›¾
            generatePanoramaMap();
            
            // ç”Ÿæˆåœ°ç‚¹é¡µé¢
            generateLocationPages();
            
            // è®¾ç½®éŸ³ä¹æ§åˆ¶
            setupMusicControls();
            
            // æ ¹æ®ä¿å­˜çš„çŠ¶æ€æ¢å¤æ¸¸æˆ
            restoreGameState();
            
            // æ˜¾ç¤ºä¿å­˜çš„æç¤º
            showSaveIndicator();
        }
        
        // ç”Ÿæˆå…¨æ™¯åœ°å›¾
        function generatePanoramaMap() {
            locations.forEach(location => {
                const locationElement = document.createElement('div');
                locationElement.className = 'location';
                locationElement.dataset.locationId = location.id;
                
                // æ£€æŸ¥æ˜¯å¦å·²è®¿é—®è¿‡è¯¥åœ°ç‚¹
                const isVisited = gameData.visitedLocations.includes(location.id);
                
                locationElement.innerHTML = `
                    <div class="location-icon">${location.icon}</div>
                    <h3>${location.name}</h3>
                    <p>${location.description}</p>
                    <button class="btn explore-btn" data-location-id="${location.id}">
                        ${isVisited ? 'å†æ¬¡æ¢ç´¢' : 'å¼€å§‹æ¢ç´¢'}
                    </button>
                `;
                
                panoramaMap.appendChild(locationElement);
            });
            
            // æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨
            document.querySelectorAll('.explore-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const locationId = this.dataset.locationId;
                    visitLocation(locationId);
                });
            });
        }
        
        // ç”Ÿæˆåœ°ç‚¹é¡µé¢
        function generateLocationPages() {
            locations.forEach(location => {
                const locationPage = document.createElement('div');
                locationPage.className = 'location-page';
                locationPage.id = `${location.id}-page`;
                
                locationPage.innerHTML = `
                    <div class="location-header">
                        <h2>${location.name}</h2>
                        <button class="btn back-btn">è¿”å›å…¨æ™¯åœ°å›¾</button>
                    </div>
                    <div class="location-content">
                        
                        <div class="location-description">
                            <h3>æ¢ç´¢è¯¦æƒ…</h3>
                            <p>${location.content}</p>
                            <div style="margin-top: 20px;">
                                <button class="btn found-treasure-btn" data-location-id="${location.id}">æ‰¾åˆ°å®è—ï¼</button>
                            </div>
                        </div>
                    </div>
                `;
                
                locationPages.appendChild(locationPage);
                
                // æ·»åŠ è¿”å›æŒ‰é’®äº‹ä»¶
                locationPage.querySelector('.back-btn').addEventListener('click', function() {
                    showPanoramaMap();
                });
                
                // æ·»åŠ æ‰¾åˆ°å®è—æŒ‰é’®äº‹ä»¶
                locationPage.querySelector('.found-treasure-btn').addEventListener('click', function() {
                    const locationId = this.dataset.locationId;
                    markLocationAsCompleted(locationId);
                });
            });
        }
        
        // è®¾ç½®éŸ³ä¹æ§åˆ¶
        function setupMusicControls() {
            // è®¾ç½®åˆå§‹éŸ³é‡
            backgroundMusic.volume = gameData.musicVolume;
            volumeSlider.value = gameData.musicVolume;
            
            // æ’­æ”¾/æš‚åœæŒ‰é’®
            playPauseBtn.addEventListener('click', function() {
                if (backgroundMusic.paused) {
                    backgroundMusic.play();
                    gameData.musicPlaying = true;
                } else {
                    backgroundMusic.pause();
                    gameData.musicPlaying = false;
                }
                saveGameData();
                updatePlayPauseButton();
            });
            
            // éŸ³é‡æ§åˆ¶
            volumeSlider.addEventListener('input', function() {
                backgroundMusic.volume = this.value;
                gameData.musicVolume = this.value;
                saveGameData();
            });
            
            // ä¸Šä¸€é¦–/ä¸‹ä¸€é¦–æŒ‰é’®ï¼ˆåœ¨åœ°ç‚¹é¡µé¢é—´åˆ‡æ¢éŸ³ä¹ï¼‰
            prevMusicBtn.addEventListener('click', function() {
                if (gameData.currentLocation !== 'panorama') {
                    const currentIndex = locations.findIndex(loc => loc.id === gameData.currentLocation);
                    const prevIndex = (currentIndex - 1 + locations.length) % locations.length;
                    visitLocation(locations[prevIndex].id);
                }
            });
            
            nextMusicBtn.addEventListener('click', function() {
                if (gameData.currentLocation !== 'panorama') {
                    const currentIndex = locations.findIndex(loc => loc.id === gameData.currentLocation);
                    const nextIndex = (currentIndex + 1) % locations.length;
                    visitLocation(locations[nextIndex].id);
                }
            });
            
            // æ›´æ–°æ’­æ”¾/æš‚åœæŒ‰é’®çŠ¶æ€
            updatePlayPauseButton();
        }
        
        // æ›´æ–°æ’­æ”¾/æš‚åœæŒ‰é’®
        function updatePlayPauseButton() {
            playPauseBtn.textContent = backgroundMusic.paused ? 'â–¶' : 'â¸';
        }
        
        // è®¿é—®åœ°ç‚¹
        function visitLocation(locationId) {
            // éšè—å…¨æ™¯åœ°å›¾
            document.querySelectorAll('.location').forEach(loc => {
                loc.style.display = 'none';
            });
            
            // æ˜¾ç¤ºé€‰å®šçš„åœ°ç‚¹é¡µé¢
            document.getElementById(`${locationId}-page`).style.display = 'block';
            
            // æ›´æ–°å½“å‰åœ°ç‚¹
            gameData.currentLocation = locationId;
            
            // å¦‚æœè¿™æ˜¯ç¬¬ä¸€æ¬¡è®¿é—®è¯¥åœ°ç‚¹ï¼Œæ·»åŠ åˆ°å·²è®¿é—®åˆ—è¡¨
            if (!gameData.visitedLocations.includes(locationId)) {
                gameData.visitedLocations.push(locationId);
            }
            
            // ä¿å­˜æ¸¸æˆæ•°æ®
            saveGameData();
            
            // æ’­æ”¾è¯¥åœ°ç‚¹çš„éŸ³ä¹
            const location = locations.find(loc => loc.id === locationId);
            if (location && location.music) {
                backgroundMusic.src = location.music;
                if (gameData.musicPlaying) {
                    backgroundMusic.play().catch(e => {
                        console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
                    });
                }
            }
        }
        
        // æ˜¾ç¤ºå…¨æ™¯åœ°å›¾
        function showPanoramaMap() {
            // éšè—æ‰€æœ‰åœ°ç‚¹é¡µé¢
            document.querySelectorAll('.location-page').forEach(page => {
                page.style.display = 'none';
            });
            
            // æ˜¾ç¤ºæ‰€æœ‰åœ°ç‚¹
            document.querySelectorAll('.location').forEach(loc => {
                loc.style.display = 'block';
            });
            
            // æ›´æ–°å½“å‰åœ°ç‚¹
            gameData.currentLocation = 'panorama';
            
            // ä¿å­˜æ¸¸æˆæ•°æ®
            saveGameData();
            
            // æ’­æ”¾å…¨æ™¯åœ°å›¾éŸ³ä¹
            backgroundMusic.src = panoramaMusic;
            if (gameData.musicPlaying) {
                backgroundMusic.play().catch(e => {
                    console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
                });
            }
        }
        
        // æ ‡è®°åœ°ç‚¹ä¸ºå·²å®Œæˆï¼ˆæ‰¾åˆ°å®è—ï¼‰
        function markLocationAsCompleted(locationId) {
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„é€»è¾‘
            alert(`æ­å–œï¼ä½ åœ¨${locations.find(loc => loc.id === locationId).name}æ‰¾åˆ°äº†å®è—ï¼`);
            
            // è¿”å›å…¨æ™¯åœ°å›¾
            showPanoramaMap();
        }
        
        // æ¢å¤æ¸¸æˆçŠ¶æ€
        function restoreGameState() {
            // æ ¹æ®ä¿å­˜çš„çŠ¶æ€æ˜¾ç¤ºç›¸åº”çš„é¡µé¢
            if (gameData.currentLocation === 'panorama') {
                showPanoramaMap();
            } else {
                visitLocation(gameData.currentLocation);
            }
            
            // æ›´æ–°å·²è®¿é—®åœ°ç‚¹çš„æ ·å¼
            gameData.visitedLocations.forEach(locationId => {
                const locationElement = document.querySelector(`[data-location-id="${locationId}"]`);
                if (locationElement) {
                    locationElement.style.border = '2px solid gold';
                    locationElement.querySelector('.explore-btn').textContent = 'å†æ¬¡æ¢ç´¢';
                }
            });
        }
        
        // ä¿å­˜æ¸¸æˆæ•°æ®
        function saveGameData() {
            localStorage.setItem('currentLocation', gameData.currentLocation);
            localStorage.setItem('visitedLocations', JSON.stringify(gameData.visitedLocations));
            localStorage.setItem('musicVolume', gameData.musicVolume);
            localStorage.setItem('musicPlaying', gameData.musicPlaying);
            
            // æ˜¾ç¤ºä¿å­˜æç¤º
            showSaveIndicator();
        }
        
        // æ˜¾ç¤ºä¿å­˜æç¤º
        function showSaveIndicator() {
            saveIndicator.style.display = 'block';
            setTimeout(() => {
                saveIndicator.style.display = 'none';
            }, 2000);
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        window.addEventListener('DOMContentLoaded', initGame);
        
        // å¤„ç†é¡µé¢å¯è§æ€§å˜åŒ–ï¼ˆå½“ç”¨æˆ·åˆ‡æ¢æ ‡ç­¾é¡µæ—¶æš‚åœéŸ³ä¹ï¼‰
        document.addEventListener('visibilitychange', function() {
            if (document.hidden) {
                // é¡µé¢ä¸å¯è§ï¼Œä¿å­˜éŸ³ä¹çŠ¶æ€
                gameData.musicPlaying = !backgroundMusic.paused;
                if (!backgroundMusic.paused) {
                    backgroundMusic.pause();
                }
                saveGameData();
            } else {
                // é¡µé¢å¯è§ï¼Œæ¢å¤éŸ³ä¹çŠ¶æ€
                if (gameData.musicPlaying) {
                    backgroundMusic.play().catch(e => {
                        console.log('è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€è¦ç”¨æˆ·äº¤äº’');
                    });
                }
            }
        });
    </script>
</body>
</html>